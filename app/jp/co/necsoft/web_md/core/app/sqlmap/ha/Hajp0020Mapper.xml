<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jp.co.necsoft.web_md.core.ha.hajp0020.dao.Hajp0020Mapper">
<resultMap id="Hajp0020H010HNBHResultMap" type="jp.co.necsoft.web_md.core.common.mybatis.dto.H010hnbh" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 22 09:53:11 JST 2014.
    -->
    <result column="SHN_CD" property="shnCd" jdbcType="VARCHAR" />
    <result column="KAI_CD" property="kaiCd" jdbcType="VARCHAR" />
    <result column="JGB_CD" property="jgbCd" jdbcType="VARCHAR" />
    <result column="TEN_CD" property="tenCd" jdbcType="VARCHAR" />
    <result column="HAT_DD" property="hatDd" jdbcType="VARCHAR" />
    <result column="NHN_DD" property="nhnDd" jdbcType="VARCHAR" />
    <result column="TEISEI_KBN" property="teiseiKbn" jdbcType="VARCHAR" />
    <result column="HAT_SRUI_KBN" property="hatSruiKbn" jdbcType="VARCHAR" />
    <result column="BIN" property="bin" jdbcType="VARCHAR" />
    <result column="HAT_SU" property="hatSu" jdbcType="DECIMAL" />
    <result column="TRI_CD" property="triCd" jdbcType="VARCHAR" />
    <result column="GENK" property="genk" jdbcType="DECIMAL" />
    <result column="BAIK" property="baik" jdbcType="DECIMAL" />
    <result column="HATTYU_IRISU" property="hattyuIrisu" jdbcType="DECIMAL" />
    <result column="HAT_TRI_DD" property="hatTriDd" jdbcType="VARCHAR" />
    <result column="HAT_TRI_TIME" property="hatTriTime" jdbcType="VARCHAR" />
    <result column="HAT_CHU_FLG" property="hatChuFlg" jdbcType="VARCHAR" />
    <result column="HAT_SIME_FLG" property="hatSimeFlg" jdbcType="VARCHAR" />
    <result column="CMN_TANTO_CD" property="cmnTantoCd" jdbcType="VARCHAR" />
    <result column="CMN_TERM_ID" property="cmnTermId" jdbcType="VARCHAR" />
    <result column="CMN_INSDD" property="cmnInsdd" jdbcType="VARCHAR" />
    <result column="CMN_UPDDD" property="cmnUpddd" jdbcType="VARCHAR" />
    <result column="CMN_UPDTIME" property="cmnUpdtime" jdbcType="VARCHAR" />
  </resultMap>
  <select id="selectH010hnbhM009msym01" parameterType="jp.co.necsoft.web_md.core.app.dto.ha.H010hnbhM009msymExecute" resultMap="Hajp0020H010HNBHResultMap">
    <!--
      This element is generated from HABN0020#Execute.
    -->
    <!-- 2014/03/06 自動生成後の変更NECVN) Quylh add start  -->
    <!--
    SELECT
        *
      FROM
        H010HNBH
      WHERE
        KAI_CD = #{kaiCd}
        AND JGB_CD = #{jgbCd}
        AND TEN_CD = #{tenCd}
        AND HAT_DD = #{hatDd}
        AND NHN_DD = #{nhnDd} 
    @if (!sHatSruiKbn.equals(""))@
        AND HAT_SRUI_KBN = #{hatSruiKbn} 
    @endif@ 
    @if (!sFromJanCd.equals(""))@
        AND SHN_CD >= #{>} 
    @endif@
        AND HAT_SU <> 0
      ORDER BY
        HAT_SRUI_KBN
        ,BIN
        ,SHN_CD
        -->        
        SELECT *
		FROM H010HNBH
		WHERE (SHN_CD,TEN_CD) IN
      		  (SELECT JAN_CD,SUBSTR(TEN_CD,5,3)
               FROM M009MSYM
               WHERE (JAN_CD,TEN_CD,HAKKO_DAY) IN
                     (SELECT JAN_CD,TEN_CD,MAX(HAKKO_DAY)
                      FROM M009MSYM
                      WHERE HAKKO_DAY    <![CDATA[ <= ]]> #{hatDd}
                      AND HAKKO_DAY_TO <![CDATA[ >= ]]> #{hatDd}
                      AND TEN_CD = #{tenCd7}
                      GROUP BY JAN_CD,TEN_CD
                      )
              <if test="bmnCd != '' and bmnCd != null">
              	AND BMN_CD = #{bmnCd}
              </if>
              )
		AND KAI_CD       = #{kaiCd}
		AND JGB_CD       = #{jgbCd}
		AND TEN_CD       = #{tenCd}
		AND HAT_SRUI_KBN = #{hatSruiKbn}
		AND NHN_DD = #{nhnDd}
		AND HAT_SU <![CDATA[ <> ]]> 0
		ORDER BY BIN,SHN_CD
         <!-- 2014/03/06 自動生成後の変更NECVN) Quylh add end  -->
  </select>
  <select id="selectH010hnbh02" parameterType="jp.co.necsoft.web_md.core.app.dto.ha.H010hnbhExecuteHNBH" resultMap="Hajp0020H010HNBHResultMap">
    <!--
      This element is generated from HABN0020#ExecuteHNBH.
    -->
    SELECT
        *
      FROM
        H010HNBH
      WHERE
        SHN_CD = #{shnCd}
        AND KAI_CD = #{kaiCd}
        AND JGB_CD = #{jgbCd}
        AND TEN_CD = #{tenCd}
        AND HAT_DD = #{hatDd}
        <if test="nhnDd != '' and nhnDd != null">
			AND NHN_DD = #{nhnDd}
		</if>
        AND HAT_SRUI_KBN = #{hatSruiKbn}
        AND BIN = #{bin} 
    <if test="bHatSu == false">
    	AND HAT_SU  <![CDATA[ <> ]]> 0 
    </if>
        
  </select> 
  
</mapper>
